@page "/fooditems"
@using Macronutrients.Data
@using Macronutrients.Models
@using Macronutrients.Components
@using Microsoft.AspNetCore.Components.Forms
@using System.Runtime.InteropServices.JavaScript
@using System.ComponentModel.DataAnnotations

<PageTitle>Food Items</PageTitle>

<section id="FoodItemsPage">    
    <section id="FoodItemsPage-Header">Header</section>
    <section id="FoodItemsPage-Body">
        <div id="AllFoodsList">
            All Foods<br />
            @if (foods != null && foods.Count != 0)
            {
                @foreach (var food in foods)
                {
                    <div class="FoodItem">                        
                        <span class="FoodName">@food.Name</span><br/>
                        <span class="">Protein: @food.Protein</span> <span class="spacer">--</span> <span class="">Carbs: @food.Carbs</span> <span class="spacer">--</span> <span class="">Fats: @food.Fats</span><br />
                    </div>
                }
            }
            else
            {
                <p>No Food Data exists.</p>
            }
        </div>
        <div id="ShowMacronutrients">Macronutrients</div>
        <div id="AddFoodForm">
            Add Food Form<br/>
            <EditForm id="EditFoodModal" Model="@newFood" OnValidSubmit="@HandleNewFood">
                <DataAnnotationsValidator />
                <ValidationSummary />
                <label>Name</label> <InputText @bind-Value="@newFood.Name" /><br />
                <label>Protein</label> <InputNumber @bind-Value="@newFood.Protein" /><br />
                <label>Carbs</label> <InputNumber @bind-Value="@newFood.Carbs"/><br />
                <label>Fats</label> <InputNumber @bind-Value="@newFood.Fats" /><br />
                <br />
                <button type="submit">Add Food</button>
            </EditForm>
        </div>
    </section>
    <section id="FoodItemsPage-Footer">Footer</section>
</section>

@code {
    private Food newFood = new(); 

    private List<Food> foods = FoodDataService.GetAllFoods(); 

    private async void HandleNewFood()
    {
        FoodDataService.CreateNewFood(newFood);
        foods = FoodDataService.GetAllFoods();
        newFood = new ();
    }
}

@*onclick="@(() => NutrientClick(food.Name))"*@